@model DoableFinal.ViewModels.ContentPageViewModel
@{
    ViewData["Title"] = "Home";
    var sections = ViewBag.Sections as List<DoableFinal.Models.HomePageSection> ?? new List<DoableFinal.Models.HomePageSection>();
    
    var heroTitle = sections.FirstOrDefault(s => s.SectionKey == "hero-title")?.Content ?? "<h1 class=\"display-4 fw-bold mb-4\">QONNEC</h1>";
    var heroBody = sections.FirstOrDefault(s => s.SectionKey == "hero-body")?.Content ?? "<p class=\"lead mb-4\">Streamline your projects, collaborate with your team, and achieve better results with our comprehensive project management solution.</p>";
    var heroImagePath = sections.FirstOrDefault(s => s.SectionKey == "hero-image")?.ImagePath;
    
    var feature1Title = sections.FirstOrDefault(s => s.SectionKey == "feature-1-title")?.Content ?? "Task Management";
    var feature1Body = sections.FirstOrDefault(s => s.SectionKey == "feature-1-body")?.Content ?? "Organize and track tasks with our intuitive Kanban board system.";
    
    var feature2Title = sections.FirstOrDefault(s => s.SectionKey == "feature-2-title")?.Content ?? "Team Collaboration";
    var feature2Body = sections.FirstOrDefault(s => s.SectionKey == "feature-2-body")?.Content ?? "Work together seamlessly with real-time updates and communication tools.";
    
    var feature3Title = sections.FirstOrDefault(s => s.SectionKey == "feature-3-title")?.Content ?? "Progress Tracking";
    var feature3Body = sections.FirstOrDefault(s => s.SectionKey == "feature-3-body")?.Content ?? "Monitor project progress with detailed analytics and reporting.";
    
    var ctaTitle = sections.FirstOrDefault(s => s.SectionKey == "cta-title")?.Content ?? "Ready to Get Started?";
    var ctaBody = sections.FirstOrDefault(s => s.SectionKey == "cta-body")?.Content ?? "Join thousands of teams already using our platform to manage their projects.";
}

@if (User.Identity?.IsAuthenticated == true && User.IsInRole("Admin"))
{
    <div class="alert alert-info mb-0">
        <a asp-controller="Admin" asp-action="ManageHomePage" class="btn btn-sm btn-primary">Edit Homepage Content</a>
    </div>
}

<!-- Hero Section -->
<section class="hero-section bg-primary text-white py-5 d-flex align-items-center">
    <div class="container">
        <div class="row justify-content-center text-center">
            <div class="col-lg-8">
                <h1 class="display-4 fw-bold mb-4">@Html.Raw(heroTitle)</h1>
                <p class="lead mb-4">@Html.Raw(heroBody)</p>
                @if (!string.IsNullOrEmpty(heroImagePath))
                {
                    <div class="mt-3">
                        <img src="@heroImagePath" class="img-fluid rounded" alt="Hero Image" />
                    </div>
                }
                <div class="d-flex gap-3 justify-content-center">
                    <a asp-controller="Account" asp-action="Register" class="btn btn-light btn-lg">Get Started</a>
                    <a href="#features" class="btn btn-outline-light btn-lg">Learn More</a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section id="features" class="py-5">
    <div class="container">
        <h2 class="text-center mb-5">Why Choose Us</h2>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body text-center p-4">
                        <i class="bi bi-kanban display-4 text-primary mb-3"></i>
                        <h3 class="h5" >@Html.Raw(feature1Title)</h3>
                        <p>@Html.Raw(feature1Body)</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body text-center p-4">
                        <i class="bi bi-people display-4 text-primary mb-3"></i>
                        <h3 class="h5">@Html.Raw(feature2Title)</h3>
                        <p>@Html.Raw(feature2Body)</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body text-center p-4">
                        <i class="bi bi-graph-up display-4 text-primary mb-3"></i>
                        <h3 class="h5">@Html.Raw(feature3Title)</h3>
                        <p>@Html.Raw(feature3Body)</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="bg-light py-5">
    <div class="container text-center">
        <h2 class="mb-4">@Html.Raw(ctaTitle)</h2>
        <p class="lead mb-4">@Html.Raw(ctaBody)</p>
        <a asp-controller="Account" asp-action="Register" class="btn btn-primary btn-lg">Create Free Account</a>
    </div>
</section>
